[["PreProc","#!/usr/bin/perl"],["","\n\n"],["Statement","use strict"],["",";\n"],["Statement","use warnings"],["",";\n\n"],["Statement","use "],["","Data::Dumper;\n"],["Statement","use "],["","B::Deparse;\n"],["Statement","use "],["","Template;\n"],["Statement","use "],["","Getopt::Long;\n"],["Statement","use "],["","CGI;\n\n"],["Statement","use "],["","Class::MOP;\n\n"],["Statement","my"],[""," "],["Identifier","$stand_alone"],[""," = "],["Number","0"],["",";\nGetOptions("],["String","\"s\""],[""," => \\"],["Identifier","$stand_alone"],["",");\n\n"],["Conditional","if"],[""," ("],["Identifier","$stand_alone"],["",") {\n    "],["Statement","require"],[""," HTTP::Server::Simple::CGI;\n    {\n        package "],["Comment","# hide me from PAUSE"],["","\n            Class::MOP::Browser::Server;\n        "],["Statement","our"],[""," "],["Identifier","@ISA"],[""," = "],["String","qw(HTTP::Server::Simple::CGI)"],["",";\n        "],["Keyword","sub "],["Function","handle_request "],["","{ ::process_template() }\n    }\n    Class::MOP::Browser::Server->new()->run();\n}\n"],["Conditional","else"],[""," {\n    "],["Statement","print"],[""," CGI::header();\n    process_template();\n}\n\n{\n    "],["Statement","my"],[""," "],["Identifier","$DATA"],["",";\n    "],["Keyword","sub "],["Function","process_template "],["","{\n        "],["Identifier","$DATA"],[""," ||= "],["Statement","join"],[""," "],["String","\"\""],[""," => "],["Identifier","<DATA>"],["",";\n        Template->new->process(\n            \\"],["Identifier","$DATA"],["",",\n            {\n                "],["String","'get_all_metaclasses'"],["","   => \\"],["Identifier","&"],["Type","::"],["Identifier","get_all_metaclasses"],["",",\n                "],["String","'get_metaclass_by_name'"],[""," => \\"],["Identifier","&"],["Type","::"],["Identifier","get_metaclass_by_name"],["",",\n                "],["String","'deparse_method'"],["","        => \\"],["Identifier","&"],["Type","::"],["Identifier","deparse_method"],["",",\n                "],["String","'deparse_item'"],["","          => \\"],["Identifier","&"],["Type","::"],["Identifier","deparse_item"],["",",\n            }\n        ) "],["Operator","or"],[""," "],["Statement","warn"],[""," Template->error;\n    }\n}\n\n"],["Keyword","sub "],["Function","get_all_metaclasses "],["","{\n    "],["Statement","sort"],[""," "],["Statement","{"],[""," "],["Identifier","$a"],["","->name "],["Operator","cmp"],[""," "],["Identifier","$b"],["","->name "],["Statement","}"],[""," Class::MOP::get_all_metaclass_instances()\n}\n\n"],["Keyword","sub "],["Function","get_metaclass_by_name "],["","{\n    Class::MOP::get_metaclass_by_name("],["Identifier","@_"],["",");\n}\n\n"],["Keyword","sub "],["Function","deparse_method "],["","{\n    "],["Statement","my"],[""," ("],["Identifier","$method"],["",") = "],["Identifier","@_"],["",";\n    "],["Statement","my"],[""," "],["Identifier","$deparse"],[""," = B::Deparse->new("],["String","\"-d\""],["",");\n    "],["Statement","my"],[""," "],["Identifier","$body"],[""," = "],["Identifier","$deparse"],["","->coderef2text("],["Identifier","$method"],["","->body());\n    "],["Statement","return"],[""," "],["String","\"sub \""],[""," . "],["Identifier","$method"],["","->name . "],["String","' '"],[""," . _clean_deparse_code("],["Identifier","$body"],["",");\n}\n\n"],["Keyword","sub "],["Function","deparse_item "],["","{\n    "],["Statement","my"],[""," ("],["Identifier","$item"],["",") = "],["Identifier","@_"],["",";\n    "],["Statement","return"],[""," "],["Identifier","$item"],[""," "],["Conditional","unless"],[""," "],["Operator","ref"],[""," "],["Identifier","$item"],["",";\n    "],["Statement","local"],[""," "],["Identifier","$"],["Type","Data::Dumper::"],["Identifier","Deparse"],[""," = "],["Number","1"],["",";\n    "],["Statement","local"],[""," "],["Identifier","$"],["Type","Data::Dumper::"],["Identifier","Indent"],["","  = "],["Number","1"],["",";\n    "],["Statement","my"],[""," "],["Identifier","$dumped"],[""," = Dumper "],["Identifier","$item"],["",";\n    "],["Identifier","$dumped"],[""," =~ "],["Statement","s/"],["String","^"],["Special","\\$"],["String","VAR1"],["Special","\\s"],["String","="],["Special","\\s"],["Statement","//"],["",";\n    "],["Identifier","$dumped"],[""," =~ "],["Statement","s/"],["Special","\\;"],["String","$"],["Statement","//"],["",";\n    "],["Statement","return"],[""," _clean_deparse_code("],["Identifier","$dumped"],["",");\n}\n\n"],["Keyword","sub "],["Function","_clean_deparse_code "],["","{\n    "],["Statement","my"],[""," "],["Identifier","@body"],[""," = "],["Statement","split"],[""," "],["Statement","/"],["Special","\\n"],["Statement","/"],[""," => "],["Identifier","$_["],["Number","0"],["Identifier","]"],["",";\n    "],["Statement","my"],[""," "],["Identifier","@cleaned"],["",";\n    "],["Repeat","foreach"],[""," ("],["Identifier","@body"],["",") {\n        "],["Statement","next"],[""," "],["Conditional","if"],[""," "],["Statement","/"],["String","^"],["Special","\\s+"],["String","use"],["Statement","/"],["",";\n        "],["Statement","next"],[""," "],["Conditional","if"],[""," "],["Statement","/"],["String","^"],["Special","\\s+"],["String","BEGIN"],["Statement","/"],["",";\n        "],["Statement","next"],[""," "],["Conditional","if"],[""," "],["Statement","/"],["String","^"],["Special","\\s+"],["String","package"],["Statement","/"],["",";\n        "],["Statement","push"],[""," "],["Identifier","@cleaned"],[""," => "],["Identifier","$_"],["",";\n    }\n    "],["Statement","return"],[""," ("],["Statement","join"],[""," "],["String","\""],["Special","\\n"],["String","\""],[""," => "],["Identifier","@cleaned"],["",");\n}\n\n"],["Number","1"],["",";\n\n"],["Comment","## This is the template file to be used"],["","\n\n"],["Comment","__DATA__"],["","\n"],["Comment","[% USE q = CGI %]"],["","\n\n"],["Comment","[% area = 'attributes' %]"],["","\n"],["Comment","[% IF q.param('area') %]"],["","\n"],["Comment","    [% area = q.param('area') %]"],["","\n"],["Comment","[% END %]"],["","\n\n"],["Comment","<html>"],["","\n"],["Comment","<head>"],["","\n"],["Comment","<title>Class::MOP Browser</title>"],["","\n"],["Comment","<style type='text/css'>"],["","\n\n"],["Comment","body {"],["","\n"],["Comment","    font-family: arial;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","td { font-size: 12px; }"],["","\n"],["Comment","b  { font-size: 12px; }"],["","\n\n"],["Comment","pre {"],["","\n"],["Comment","    font-family: courier;"],["","\n"],["Comment","    font-size:   12px;"],["","\n"],["Comment","    width:       330px;"],["","\n"],["Comment","    padding:     10px;"],["","\n"],["Comment","    overflow:    auto;"],["","\n"],["Comment","    border:      1px dotted green;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","A {"],["","\n"],["Comment","    font-family: arial;"],["","\n"],["Comment","    font-size:   12px;"],["","\n"],["Comment","    color: black;"],["","\n"],["Comment","    text-decoration: none;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","A:hover {"],["","\n"],["Comment","    text-decoration: underline;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","td.lightblue  {"],["","\n"],["Comment","    background-color: #99BBFF;"],["","\n"],["Comment","    border-right:  1px solid #336699;"],["","\n"],["Comment","    border-bottom: 1px solid #336699;"],["","\n"],["Comment","    border-top:    1px solid #BBDDFF;"],["","\n"],["Comment","    border-left:   1px solid #BBDDFF;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","td.grey       {"],["","\n"],["Comment","    background-color: #CCCCCC;"],["","\n"],["Comment","    border-right:  1px solid #888888;"],["","\n"],["Comment","    border-bottom: 1px solid #888888;"],["","\n"],["Comment","    border-top:    1px solid #DDDDDD;"],["","\n"],["Comment","    border-left:   1px solid #DDDDDD;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","td.manila     {"],["","\n"],["Comment","    background-color: #FFDD99;"],["","\n"],["Comment","    border-right:  2px solid #CC9933;"],["","\n"],["Comment","    border-bottom: 2px solid #CC9933;"],["","\n"],["Comment","    border-top:    2px solid #FFFFBB;"],["","\n"],["Comment","    border-left:   2px solid #FFFFBB;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","td.darkgreen  {"],["","\n"],["Comment","    background-color: #33CC33;"],["","\n"],["Comment","    border-right:  1px solid #009900;"],["","\n"],["Comment","    border-bottom: 1px solid #009900;"],["","\n"],["Comment","    color: #CCFFCC;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","td.lightgreen {"],["","\n"],["Comment","    background-color: #AAFFAA;"],["","\n"],["Comment","    border-right:  1px solid #33FF33;"],["","\n"],["Comment","    border-bottom: 1px solid #33FF33;"],["","\n"],["Comment","}"],["","\n\n"],["Comment","</style>"],["","\n"],["Comment","</head>"],["","\n"],["Comment","<body>"],["","\n"],["Comment","<h1>Class::MOP Browser</h1>"],["","\n"],["Comment","<table bgcolor='#CCCCCC' cellpadding='0' cellspacing='0' border='0' align='center' height='400'>"],["","\n"],["Comment","<tr valign='top'>"],["","\n\n"],["Comment","<td rowspan='2' width='200'><table cellspacing='0' cellpadding='5' border='0' width='100%'>"],["","\n"],["Comment","    [% FOREACH metaclass IN get_all_metaclasses() %]"],["","\n"],["Comment","        <tr>"],["","\n"],["Comment","        [% IF q.param('class') == metaclass.name %]"],["","\n"],["Comment","            <td class='lightblue'><b>[% metaclass.name %]</b></td>"],["","\n"],["Comment","        [% ELSE %]"],["","\n"],["Comment","            <td class='grey'><a href='?class=[% metaclass.name %]'>[% metaclass.name %]</a></td>"],["","\n"],["Comment","        [% END %]"],["","\n"],["Comment","        </tr>"],["","\n"],["Comment","    [% END %]"],["","\n"],["Comment","    </table></td>"],["","\n"],["Comment","<td height='10' width='250'><table cellspacing='0' cellpadding='5' border='0' width='100%'>"],["","\n"],["Comment","    <tr align='center'>"],["","\n"],["Comment","    [% FOREACH area_name IN [ 'attributes', 'methods', 'superclasses' ] %]"],["","\n"],["Comment","        [% IF q.param('class') %]"],["","\n"],["Comment","            [% IF area == area_name %]"],["","\n"],["Comment","                <td class='manila'><b>[% area_name %]</b></td>"],["","\n"],["Comment","            [% ELSE %]"],["","\n"],["Comment","                <td class='lightblue'><a href='?class=[% q.param('class') %]&area=[% area_name %]'>[% area_name %]</a></td>"],["","\n"],["Comment","            [% END %]"],["","\n"],["Comment","        [% ELSE %]"],["","\n"],["Comment","            <td class='lightblue' style=\"color: #336699;\">[% area_name %]</td>"],["","\n"],["Comment","        [% END %]"],["","\n"],["Comment","    [% END %]"],["","\n"],["Comment","    </tr>"],["","\n"],["Comment","    </table></td>"],["","\n\n"],["Comment","<td valign='top' rowspan='2' class='lightgreen' width='450'>"],["","\n"],["Comment","    <table cellspacing='0' cellpadding='3' border='0'>"],["","\n"],["Comment","    <tr>"],["","\n"],["Comment","    <td class='darkgreen' width='100'></td>"],["","\n"],["Comment","    <td class='darkgreen' width='350'></td>"],["","\n"],["Comment","    </tr>"],["","\n"],["Comment","    [% IF q.param('class') && area == 'attributes' && q.param('attr') %]"],["","\n\n"],["Comment","    [%"],["","\n"],["Comment","        meta = get_metaclass_by_name(q.param('class'))"],["","\n"],["Comment","        attr = meta.get_attribute(q.param('attr'))"],["","\n"],["Comment","    %]"],["","\n\n"],["Comment","        [% FOREACH aspect IN [ 'name', 'init_arg', 'reader', 'writer', 'accessor', 'predicate', 'default' ]%]"],["","\n"],["Comment","            [% item = attr.$aspect() %]"],["","\n"],["Comment","            <tr>"],["","\n"],["Comment","            <td class='darkgreen' align='right' valign='top'>[% aspect %]</td>"],["","\n"],["Comment","            <td class='lightgreen'>[% IF item == undef %]&mdash;[% ELSE %]<pre>[% deparse_item(item) %]</pre>[% END %]</td>"],["","\n"],["Comment","            </tr>"],["","\n"],["Comment","        [% END %]"],["","\n\n"],["Comment","    [% ELSIF q.param('class') && area == 'methods' && q.param('method') %]"],["","\n\n"],["Comment","    [%"],["","\n"],["Comment","        meta = get_metaclass_by_name(q.param('class'))"],["","\n"],["Comment","        method = meta.get_method(q.param('method'))"],["","\n"],["Comment","    %]"],["","\n\n"],["Comment","        [% FOREACH aspect IN [ 'name', 'package_name', 'fully_qualified_name' ]%]"],["","\n"],["Comment","            <tr>"],["","\n"],["Comment","            <td class='darkgreen' align='right' valign='top'>[% aspect %]</td>"],["","\n"],["Comment","            <td class='lightgreen'>[% method.$aspect() %]</td>"],["","\n"],["Comment","            </tr>"],["","\n"],["Comment","        [% END %]"],["","\n"],["Comment","            <tr>"],["","\n"],["Comment","            <td class='darkgreen' align='right' valign='top'>body</td>"],["","\n"],["Comment","            <td class='lightgreen'><pre>[% deparse_method(method) %]</pre></td>"],["","\n"],["Comment","            </tr>"],["","\n\n"],["Comment","    [% END %]"],["","\n"],["Comment","    </table></td>"],["","\n\n"],["Comment","</tr>"],["","\n"],["Comment","<tr>"],["","\n\n"],["Comment","[% IF q.param('class') && area %]"],["","\n\n"],["Comment","[% meta = get_metaclass_by_name(q.param('class')) %]"],["","\n\n"],["Comment","<td class='lightblue' valign='top'><div style='height: 100%; overflow: auto;'><table cellspacing='0' cellpadding='5' border='0' width='100%'>"],["","\n\n"],["Comment","    [% IF area == 'methods' %]"],["","\n"],["Comment","        [% FOREACH method IN meta.get_method_list.sort %]"],["","\n"],["Comment","            <tr>"],["","\n"],["Comment","                [% IF q.param('method') == method %]"],["","\n"],["Comment","                    <td class='darkgreen'><b>[% method %]</b></td>"],["","\n"],["Comment","                [% ELSE %]"],["","\n"],["Comment","                    <td class='manila'><a href='?class=[% q.param('class') %]&area=[% q.param('area') %]&method=[% method %]'>[% method %]</a></td>"],["","\n"],["Comment","                [% END %]"],["","\n"],["Comment","            </tr>"],["","\n"],["Comment","        [% END %]"],["","\n"],["Comment","    [% END %]"],["","\n"],["Comment","    [% IF area == 'attributes' %]"],["","\n"],["Comment","        [% FOREACH attr IN meta.get_attribute_list.sort %]"],["","\n"],["Comment","            <tr>"],["","\n"],["Comment","                [% IF q.param('attr') == attr %]"],["","\n"],["Comment","                    <td class='darkgreen'><b>[% attr %]</b></td>"],["","\n"],["Comment","                [% ELSE %]"],["","\n"],["Comment","                    <td class='manila'><a href='?class=[% q.param('class') %]&area=[% q.param('area') %]&attr=[% attr %]'>[% attr %]</a></td>"],["","\n"],["Comment","                [% END %]"],["","\n"],["Comment","            </tr>"],["","\n"],["Comment","        [% END %]"],["","\n"],["Comment","    [% END %]"],["","\n"],["Comment","    [% IF area == 'superclasses' %]"],["","\n"],["Comment","        [% FOREACH super IN meta.superclasses.sort %]"],["","\n"],["Comment","            <tr>"],["","\n"],["Comment","                <td class='manila'><a href='?class=[% super %]'>[% super %]</a></td>"],["","\n"],["Comment","            </tr>"],["","\n"],["Comment","        [% END %]"],["","\n"],["Comment","    [% END %]"],["","\n"],["Comment","    </table></div></td>"],["","\n"],["Comment","[% END %]"],["","\n\n"],["Comment","</tr>"],["","\n"],["Comment","</table>"],["","\n"],["Comment","</body>"],["","\n"],["Comment","</html>"],["","\n\n"]]