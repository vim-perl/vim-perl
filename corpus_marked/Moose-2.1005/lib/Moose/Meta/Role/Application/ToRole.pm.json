[["Statement","package"],["Type"," Moose::Meta::Role::Application::ToRole"],["",";\n"],["PreProc","BEGIN "],["","{\n  "],["Identifier","$"],["Type","Moose::Meta::Role::Application::ToRole::"],["Identifier","AUTHORITY"],[""," = "],["String","'cpan:STEVAN'"],["",";\n}\n{\n  "],["Identifier","$"],["Type","Moose::Meta::Role::Application::ToRole::"],["Identifier","VERSION"],[""," = "],["String","'2.1005'"],["",";\n}\n\n"],["Statement","use strict"],["",";\n"],["Statement","use warnings"],["",";\n"],["Statement","use "],["","metaclass;\n\n"],["Statement","use "],["","Scalar::Util    "],["String","'blessed'"],["",";\n\n"],["Statement","use base"],[""," "],["String","'Moose::Meta::Role::Application'"],["",";\n\n"],["Keyword","sub "],["Function","apply "],["","{\n    "],["Statement","my"],[""," ("],["Identifier","$self"],["",", "],["Identifier","$role1"],["",", "],["Identifier","$role2"],["",") = "],["Identifier","@_"],["",";\n    "],["Identifier","$self"],["","->SUPER::apply("],["Identifier","$role1"],["",", "],["Identifier","$role2"],["",");\n    "],["Identifier","$role2"],["","->add_role("],["Identifier","$role1"],["",");\n}\n\n"],["Keyword","sub "],["Function","check_role_exclusions "],["","{\n    "],["Statement","my"],[""," ("],["Identifier","$self"],["",", "],["Identifier","$role1"],["",", "],["Identifier","$role2"],["",") = "],["Identifier","@_"],["",";\n    "],["Conditional","if"],[""," ( "],["Identifier","$role2"],["","->excludes_role("],["Identifier","$role1"],["","->name) ) {\n        "],["Statement","require"],[""," Moose;\n        Moose->throw_error("],["String","\"Conflict detected: \""],[""," . "],["Identifier","$role2"],["","->name . "],["String","\" excludes role '\""],[""," . "],["Identifier","$role1"],["","->name . "],["String","\"'\""],["",");\n    }\n    "],["Repeat","foreach"],[""," "],["Statement","my"],[""," "],["Identifier","$excluded_role_name"],[""," ("],["Identifier","$role1"],["","->get_excluded_roles_list) {\n        "],["Conditional","if"],[""," ( "],["Identifier","$role2"],["","->does_role("],["Identifier","$excluded_role_name"],["",") ) {\n            "],["Statement","require"],[""," Moose;\n            Moose->throw_error("],["String","\"The role \""],[""," . "],["Identifier","$role2"],["","->name . "],["String","\" does the excluded role '"],["Identifier","$excluded_role_name"],["String","'\""],["",");\n        }\n        "],["Identifier","$role2"],["","->add_excluded_roles("],["Identifier","$excluded_role_name"],["",");\n    }\n}\n\n"],["Keyword","sub "],["Function","check_required_methods "],["","{\n    "],["Statement","my"],[""," ("],["Identifier","$self"],["",", "],["Identifier","$role1"],["",", "],["Identifier","$role2"],["",") = "],["Identifier","@_"],["",";\n    "],["Repeat","foreach"],[""," "],["Statement","my"],[""," "],["Identifier","$required_method"],[""," ("],["Identifier","$role1"],["","->get_required_method_list) {\n        "],["Statement","my"],[""," "],["Identifier","$required_method_name"],[""," = "],["Identifier","$required_method"],["","->name;\n\n        "],["Statement","next"],[""," "],["Conditional","if"],[""," "],["Identifier","$self"],["","->is_aliased_method("],["Identifier","$required_method_name"],["",");\n\n        "],["Identifier","$role2"],["","->add_required_methods("],["Identifier","$required_method"],["",")\n            "],["Conditional","unless"],[""," "],["Identifier","$role2"],["","->find_method_by_name("],["Identifier","$required_method_name"],["",");\n    }\n}\n\n"],["Keyword","sub "],["Function","check_required_attributes "],["","{\n\n}\n\n"],["Keyword","sub "],["Function","apply_attributes "],["","{\n    "],["Statement","my"],[""," ("],["Identifier","$self"],["",", "],["Identifier","$role1"],["",", "],["Identifier","$role2"],["",") = "],["Identifier","@_"],["",";\n    "],["Repeat","foreach"],[""," "],["Statement","my"],[""," "],["Identifier","$attribute_name"],[""," ("],["Identifier","$role1"],["","->get_attribute_list) {\n        "],["Comment","# it if it has one already"],["","\n        "],["Conditional","if"],[""," ("],["Identifier","$role2"],["","->has_attribute("],["Identifier","$attribute_name"],["",") &&\n            "],["Comment","# make sure we haven't seen this one already too"],["","\n            "],["Identifier","$role2"],["","->get_attribute("],["Identifier","$attribute_name"],["",") != "],["Identifier","$role1"],["","->get_attribute("],["Identifier","$attribute_name"],["",")) {\n\n            "],["Statement","my"],[""," "],["Identifier","$role2_name"],[""," = "],["Identifier","$role2"],["","->name;\n\n            "],["Statement","require"],[""," Moose;\n            Moose->throw_error( "],["String","\"Role '\""],["","\n                    . "],["Identifier","$role1"],["","->name\n                    . "],["String","\"' has encountered an attribute conflict\""],["","\n                    . "],["String","\" while being composed into '"],["Identifier","$role2_name"],["String","'.\""],["","\n                    . "],["String","\" This is a fatal error and cannot be disambiguated.\""],["","\n                    . "],["String","\" The conflicting attribute is named '"],["Identifier","$attribute_name"],["String","'.\""],[""," );\n        }\n        "],["Conditional","else"],[""," {\n            "],["Identifier","$role2"],["","->add_attribute(\n                "],["Identifier","$role1"],["","->get_attribute("],["Identifier","$attribute_name"],["",")->clone\n            );\n        }\n    }\n}\n\n"],["Keyword","sub "],["Function","apply_methods "],["","{\n    "],["Statement","my"],[""," ( "],["Identifier","$self"],["",", "],["Identifier","$role1"],["",", "],["Identifier","$role2"],[""," ) = "],["Identifier","@_"],["",";\n    "],["Repeat","foreach"],[""," "],["Statement","my"],[""," "],["Identifier","$method"],[""," ( "],["Identifier","$role1"],["","->_get_local_methods ) {\n\n        "],["Statement","my"],[""," "],["Identifier","$method_name"],[""," = "],["Identifier","$method"],["","->name;\n\n        "],["Statement","next"],[""," "],["Conditional","if"],[""," "],["Identifier","$method"],["","->isa("],["String","'Class::MOP::Method::Meta'"],["",");\n\n        "],["Conditional","unless"],[""," ( "],["Identifier","$self"],["","->is_method_excluded("],["Identifier","$method_name"],["",") ) {\n\n            "],["Statement","my"],[""," "],["Identifier","$role2_method"],[""," = "],["Identifier","$role2"],["","->get_method("],["Identifier","$method_name"],["",");\n            "],["Conditional","if"],[""," (   "],["Identifier","$role2_method"],["","\n                && "],["Identifier","$role2_method"],["","->body != "],["Identifier","$method"],["","->body ) {\n\n                "],["Comment","# method conflicts between roles used to result in the method"],["","\n                "],["Comment","# becoming a requirement but now are permitted just like"],["","\n                "],["Comment","# for classes, hence no code in this branch anymore."],["","\n            }\n            "],["Conditional","else"],[""," {\n                "],["Identifier","$role2"],["","->add_method(\n                    "],["Identifier","$method_name"],["",",\n                    "],["Identifier","$method"],["",",\n                );\n            }\n        }\n\n        "],["Statement","next"],[""," "],["Conditional","unless"],[""," "],["Identifier","$self"],["","->is_method_aliased("],["Identifier","$method_name"],["",");\n\n        "],["Statement","my"],[""," "],["Identifier","$aliased_method_name"],[""," = "],["Identifier","$self"],["","->get_method_aliases->{"],["Identifier","$method_name"],["","};\n\n        "],["Statement","my"],[""," "],["Identifier","$role2_method"],[""," = "],["Identifier","$role2"],["","->get_method("],["Identifier","$aliased_method_name"],["",");\n\n        "],["Conditional","if"],[""," (   "],["Identifier","$role2_method"],["","\n            && "],["Identifier","$role2_method"],["","->body != "],["Identifier","$method"],["","->body ) {\n\n            "],["Statement","require"],[""," Moose;\n            Moose->throw_error(\n                "],["String","\"Cannot create a method alias if a local method of the same name exists\""],["","\n            );\n        }\n\n        "],["Identifier","$role2"],["","->add_method(\n            "],["Identifier","$aliased_method_name"],["",",\n            "],["Identifier","$role1"],["","->get_method("],["Identifier","$method_name"],["",")\n        );\n\n        "],["Conditional","if"],[""," ( !"],["Identifier","$role2"],["","->has_method("],["Identifier","$method_name"],["",") ) {\n            "],["Identifier","$role2"],["","->add_required_methods("],["Identifier","$method_name"],["",")\n                "],["Conditional","unless"],[""," "],["Identifier","$self"],["","->is_method_excluded("],["Identifier","$method_name"],["",");\n        }\n    }\n}\n\n"],["Keyword","sub "],["Function","apply_override_method_modifiers "],["","{\n    "],["Statement","my"],[""," ("],["Identifier","$self"],["",", "],["Identifier","$role1"],["",", "],["Identifier","$role2"],["",") = "],["Identifier","@_"],["",";\n    "],["Repeat","foreach"],[""," "],["Statement","my"],[""," "],["Identifier","$method_name"],[""," ("],["Identifier","$role1"],["","->get_method_modifier_list("],["String","'override'"],["",")) {\n        "],["Comment","# it if it has one already then ..."],["","\n        "],["Conditional","if"],[""," ("],["Identifier","$role2"],["","->has_method("],["Identifier","$method_name"],["",")) {\n            "],["Comment","# if it is being composed into another role"],["","\n            "],["Comment","# we have a conflict here, because you cannot"],["","\n            "],["Comment","# combine an overridden method with a locally"],["","\n            "],["Comment","# defined one"],["","\n            "],["Statement","require"],[""," Moose;\n            Moose->throw_error("],["String","\"Role '\""],[""," . "],["Identifier","$role1"],["","->name . "],["String","\"' has encountered an 'override' method conflict \""],[""," .\n                    "],["String","\"during composition (A local method of the same name as been found). This \""],[""," .\n                    "],["String","\"is fatal error.\""],["",");\n        }\n        "],["Conditional","else"],[""," {\n            "],["Comment","# if we are a role, we need to make sure"],["","\n            "],["Comment","# we don't have a conflict with the role"],["","\n            "],["Comment","# we are composing into"],["","\n            "],["Conditional","if"],[""," ("],["Identifier","$role2"],["","->has_override_method_modifier("],["Identifier","$method_name"],["",") &&\n                "],["Identifier","$role2"],["","->get_override_method_modifier("],["Identifier","$method_name"],["",") != "],["Identifier","$role2"],["","->get_override_method_modifier("],["Identifier","$method_name"],["",")) {\n\n                "],["Statement","require"],[""," Moose;\n                Moose->throw_error("],["String","\"Role '\""],[""," . "],["Identifier","$role1"],["","->name . "],["String","\"' has encountered an 'override' method conflict \""],[""," .\n                        "],["String","\"during composition (Two 'override' methods of the same name encountered). \""],[""," .\n                        "],["String","\"This is fatal error.\""],["",");\n            }\n            "],["Conditional","else"],[""," {\n                "],["Comment","# if there is no conflict,"],["","\n                "],["Comment","# just add it to the role"],["","\n                "],["Identifier","$role2"],["","->add_override_method_modifier(\n                    "],["Identifier","$method_name"],["",",\n                    "],["Identifier","$role1"],["","->get_override_method_modifier("],["Identifier","$method_name"],["",")\n                );\n            }\n        }\n    }\n}\n\n"],["Keyword","sub "],["Function","apply_method_modifiers "],["","{\n    "],["Statement","my"],[""," ("],["Identifier","$self"],["",", "],["Identifier","$modifier_type"],["",", "],["Identifier","$role1"],["",", "],["Identifier","$role2"],["",") = "],["Identifier","@_"],["",";\n    "],["Statement","my"],[""," "],["Identifier","$add"],[""," = "],["String","\"add_"],["Identifier","${modifier_type}"],["String","_method_modifier\""],["",";\n    "],["Statement","my"],[""," "],["Identifier","$get"],[""," = "],["String","\"get_"],["Identifier","${modifier_type}"],["String","_method_modifiers\""],["",";\n    "],["Repeat","foreach"],[""," "],["Statement","my"],[""," "],["Identifier","$method_name"],[""," ("],["Identifier","$role1"],["","->get_method_modifier_list("],["Identifier","$modifier_type"],["",")) {\n        "],["Identifier","$role2"],["","->"],["Identifier","$add"],["","(\n            "],["Identifier","$method_name"],["",",\n            "],["Identifier","$_"],["","\n        ) "],["Repeat","foreach"],[""," "],["Identifier","$role1"],["","->"],["Identifier","$get"],["","("],["Identifier","$method_name"],["",");\n    }\n}\n\n\n"],["Number","1"],["",";\n\n"],["Comment","# ABSTRACT: Compose a role into another role"],["","\n\n"],["Comment","__END__"],["","\n\n"],["Statement","=pod"],["","\n\n"],["Statement","=head1"],[""," "],["String","NAME"],["","\n\nMoose::Meta::Role::Application::ToRole - Compose a role into another role\n\n"],["Statement","=head1"],[""," "],["String","VERSION"],["","\n\nversion 2.1005\n\n"],["Statement","=head1"],[""," "],["String","DESCRIPTION"],["","\n\n"],["Statement","=head2"],[""," "],["String","METHODS"],["","\n\n"],["Statement","=over"],[""," "],["Number","4"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<new>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<meta>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<apply>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<check_role_exclusions>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<check_required_methods>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<check_required_attributes>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<apply_attributes>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<apply_methods>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<apply_method_modifiers>"],["","\n\n"],["Statement","=item"],[""," "],["Identifier","B<apply_override_method_modifiers>"],["","\n\n"],["Statement","=back"],["","\n\n"],["Statement","=head1"],[""," "],["String","BUGS"],["","\n\nSee "],["Identifier","L<Moose/BUGS>"],[""," for details on reporting bugs.\n\n"],["Statement","=head1"],[""," "],["String","AUTHOR"],["","\n\nMoose is maintained by the Moose Cabal, along with the help of many contributors. See "],["Identifier","L<Moose/CABAL>"],[""," and "],["Identifier","L<Moose/CONTRIBUTORS>"],[""," for details.\n\n"],["Statement","=head1"],[""," "],["String","COPYRIGHT AND LICENSE"],["","\n\nThis software is copyright (c) 2013 by Infinity Interactive, Inc..\n\nThis is free software; you can redistribute it and/or modify it under\nthe same terms as the Perl 5 programming language system itself.\n\n"],["Statement","=cut"],["","\n"]]