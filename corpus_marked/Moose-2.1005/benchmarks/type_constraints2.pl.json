[["PreProc","#!/usr/bin/perl"],["","\n\n"],["Statement","use strict"],["",";\n"],["Statement","use warnings"],["",";\n\n"],["Statement","use "],["","Benchmark "],["String","qw[timethese]"],["",";\n\n"],["Statement","=pod"],["","\n\nThis benchmark is designed to measure how long things with type constraints\ntake (constructors, accessors). It was created to measure the impact of\ninlining type constraints.\n\n"],["Statement","=cut"],["","\n\n{\n    "],["Statement","package"],["Type"," Thing"],["",";\n\n    "],["Statement","use "],["","Moose;\n\n    has "],["String","int"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'Int'"],["",",\n    );\n\n    has "],["String","str"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'Str'"],["",",\n    );\n\n    has "],["String","fh"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'FileHandle'"],["",",\n    );\n\n    has "],["String","object"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'Object'"],["",",\n    );\n\n    has "],["String","a_int"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'ArrayRef[Int]'"],["",",\n    );\n\n    has "],["String","a_str"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'ArrayRef[Str]'"],["",",\n    );\n\n    has "],["String","a_fh"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'ArrayRef[FileHandle]'"],["",",\n    );\n\n    has "],["String","a_object"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'ArrayRef[Object]'"],["",",\n    );\n\n    has "],["String","h_int"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'HashRef[Int]'"],["",",\n    );\n\n    has "],["String","h_str"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'HashRef[Str]'"],["",",\n    );\n\n    has "],["String","h_fh"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'HashRef[FileHandle]'"],["",",\n    );\n\n    has "],["String","h_object"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'HashRef[Object]'"],["",",\n    );\n\n    __PACKAGE__->meta->make_immutable;\n}\n\n{\n    "],["Statement","package"],["Type"," Simple"],["",";\n    "],["Statement","use "],["","Moose;\n\n    has "],["String","str"],[""," => (\n        "],["String","is"],["","  => "],["String","'rw'"],["",",\n        "],["String","isa"],[""," => "],["String","'Str'"],["",",\n    );\n\n    __PACKAGE__->meta->make_immutable;\n}\n\n"],["Statement","my"],[""," "],["Identifier","@ints"],["","    = "],["Number","1"],[""," .. "],["Number","10"],["",";\n"],["Statement","my"],[""," "],["Identifier","@strs"],["","    = "],["String","'a'"],[""," .. "],["String","'j'"],["",";\n"],["Statement","my"],[""," "],["Identifier","@fhs"],["","     = "],["Statement","map"],[""," "],["Statement","{"],[""," "],["Statement","my"],[""," "],["Identifier","$fh"],["","; "],["Statement","open"],[""," "],["Identifier","$fh"],["",", "],["String","'<'"],["",", "],["Identifier","$0"],[""," "],["Operator","or"],[""," "],["Statement","die"],["","; "],["Identifier","$fh"],["","; "],["Statement","}"],[""," "],["Number","1"],[""," .. "],["Number","10"],["",";\n"],["Statement","my"],[""," "],["Identifier","@objects"],[""," = "],["Statement","map"],[""," "],["Statement","{"],[""," Thing->new "],["Statement","}"],[""," "],["Number","1"],[""," .. "],["Number","10"],["",";\n\n"],["Statement","my"],[""," "],["Identifier","%ints"],["","    = "],["Statement","map"],[""," "],["Statement","{"],[""," "],["Identifier","$_"],[""," => "],["Identifier","$_"],[""," "],["Statement","}"],[""," "],["Identifier","@ints"],["",";\n"],["Statement","my"],[""," "],["Identifier","%strs"],["","    = "],["Statement","map"],[""," "],["Statement","{"],[""," "],["Identifier","$_"],[""," => "],["Identifier","$_"],[""," "],["Statement","}"],[""," "],["Identifier","@ints"],["",";\n"],["Statement","my"],[""," "],["Identifier","%fhs"],["","     = "],["Statement","map"],[""," "],["Statement","{"],[""," "],["Identifier","$_"],[""," => "],["Identifier","$_"],[""," "],["Statement","}"],[""," "],["Identifier","@fhs"],["",";\n"],["Statement","my"],[""," "],["Identifier","%objects"],[""," = "],["Statement","map"],[""," "],["Statement","{"],[""," "],["Identifier","$_"],[""," => "],["Identifier","$_"],[""," "],["Statement","}"],[""," "],["Identifier","@objects"],["",";\n\n"],["Statement","my"],[""," "],["Identifier","$thing"],[""," = Thing->new;\n"],["Statement","my"],[""," "],["Identifier","$simple"],[""," = Simple->new;\n\ntimethese(\n    "],["Number","1_000_000"],["",", {\n        "],["String","constructor_simple"],[""," => "],["Keyword","sub "],["","{\n            Simple->new( "],["String","str"],[""," => "],["Identifier","$strs["],["Number","0"],["Identifier","]"],[""," );\n        },\n        "],["String","accessors_simple"],[""," => "],["Keyword","sub "],["","{\n            "],["Identifier","$simple"],["","->str( "],["Identifier","$strs["],["Number","0"],["Identifier","]"],[""," );\n        },\n    }\n);\n\ntimethese(\n    "],["Number","20_000"],["",", {\n        "],["String","constructor_all"],[""," => "],["Keyword","sub "],["","{\n            Thing->new(\n                "],["String","int"],["","      => "],["Identifier","$ints["],["Number","0"],["Identifier","]"],["",",\n                "],["String","str"],["","      => "],["Identifier","$strs["],["Number","0"],["Identifier","]"],["",",\n                "],["String","fh"],["","       => "],["Identifier","$fhs["],["Number","0"],["Identifier","]"],["",",\n                "],["String","object"],["","   => "],["Identifier","$objects["],["Number","0"],["Identifier","]"],["",",\n                "],["String","a_int"],["","    => \\"],["Identifier","@ints"],["",",\n                "],["String","a_str"],["","    => \\"],["Identifier","@strs"],["",",\n                "],["String","a_fh"],["","     => \\"],["Identifier","@fhs"],["",",\n                "],["String","a_object"],[""," => \\"],["Identifier","@objects"],["",",\n                "],["String","h_int"],["","    => \\"],["Identifier","%ints"],["",",\n                "],["String","h_str"],["","    => \\"],["Identifier","%strs"],["",",\n                "],["String","h_fh"],["","     => \\"],["Identifier","%fhs"],["",",\n                "],["String","h_object"],[""," => \\"],["Identifier","%objects"],["",",\n            );\n        },\n        "],["String","accessors_all"],[""," => "],["Keyword","sub "],["","{\n            "],["Identifier","$thing"],["","->"],["Statement","int"],["","( "],["Identifier","$ints["],["Number","0"],["Identifier","]"],[""," );\n            "],["Identifier","$thing"],["","->str( "],["Identifier","$strs["],["Number","0"],["Identifier","]"],[""," );\n            "],["Identifier","$thing"],["","->fh( "],["Identifier","$fhs["],["Number","0"],["Identifier","]"],[""," );\n            "],["Identifier","$thing"],["","->object( "],["Identifier","$objects["],["Number","0"],["Identifier","]"],[""," );\n            "],["Identifier","$thing"],["","->a_int( \\"],["Identifier","@ints"],[""," );\n            "],["Identifier","$thing"],["","->a_str( \\"],["Identifier","@strs"],[""," );\n            "],["Identifier","$thing"],["","->a_fh( \\"],["Identifier","@fhs"],[""," );\n            "],["Identifier","$thing"],["","->a_object( \\"],["Identifier","@objects"],[""," );\n            "],["Identifier","$thing"],["","->h_int( \\"],["Identifier","%ints"],[""," );\n            "],["Identifier","$thing"],["","->h_str( \\"],["Identifier","%strs"],[""," );\n            "],["Identifier","$thing"],["","->h_fh( \\"],["Identifier","%fhs"],[""," );\n            "],["Identifier","$thing"],["","->h_object( \\"],["Identifier","%objects"],[""," );\n        },\n    }\n);\n\n"]]